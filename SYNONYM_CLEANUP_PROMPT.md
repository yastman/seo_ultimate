# Очистка синонимов в _clean.json

---

## Промпт для Claude

```
Изучи файл categories/{slug}/data/{slug}_clean.json

Правила очистки:

1. МЕРЖИМ синонимы → победитель:
   - авто/автомобиль/машина → короткий (авто)
   - полировочная/полировальная → частотный (max volume)
   - кузов/кузова авто/кузова автомобиля → короткий
   - разный порядок слов → естественный

2. НЕ МЕРЖИМ разные интенты:
   - informational vs commercial (купить/цена)
   - разные темы (продукт vs применение vs проблема)

3. Выбор победителя:
   - Max volume в группе
   - Если volume равен → короче
   - Если длина равна → с "авто"

4. Результат:
   - Обнови JSON, удалив дубли
   - Добавь в clustering_notes что замержил
   - Удалённые слова = LSI для текста
```

---

## Цель
Подготовить **чистый список ключей для написания текста категории**:
- Убрать дубли-синонимы (авто/автомобиль/машина → одно)
- Оставить **все уникальные по смыслу** (разные интенты, темы, применения)
- Количество зависит от категории, не от жёсткого лимита

---

## Правила мержа

### 1. Авто/автомобиль/машина → оставить короткий
```
полировочная паста для авто (590)
полировочная паста для автомобиля (170)  ← УДАЛИТЬ
полировочная паста для машины (10)       ← УДАЛИТЬ
→ Победитель: "полировочная паста для авто" (590)
```

### 2. Кузов/кузова авто/кузова автомобиля → оставить короткий
```
паста для полировки кузова (40)
паста для полировки кузова авто (20)         ← УДАЛИТЬ
паста для полировки кузова автомобиля (20)   ← УДАЛИТЬ
→ Победитель: "паста для полировки кузова" (40)
```

### 3. Полировочная/полировальная → оставить частотный
```
полировочная паста (1600)  ← ОСТАВИТЬ (больше volume)
полировальная паста (20)   ← УДАЛИТЬ
```

### 4. Порядок слов → оставить естественный
```
паста для полировки авто (320)    ← ОСТАВИТЬ
пасты полировальные для авто (20) ← УДАЛИТЬ
```

### 5. С "купить"/без → разные интенты, НЕ мержить!
```
полировочная паста (1600)        — informational
купить полировочную пасту (140)  — commercial
→ ОБА остаются (разные секции)
```

---

## Структура секций

| Секция     | Назначение | Что оставлять |
|------------|------------|---------------|
| primary    | H1 + intro | Главный ключ категории |
| secondary  | H2 (виды, применение) | Уникальные подтемы |
| supporting | FAQ, таблицы | Long-tail с уникальным смыслом |
| commercial | ТОЛЬКО meta | "купить", "цена" |

---

## Workflow очистки

### Шаг 1: Группировка
Читаю JSON, нахожу группы синонимов:

```
ГРУППА 1 (базовая форма):
- полировочная паста (1600) ★ победитель
- полировальная паста (20)
- паста для полировки (320)

ГРУППА 2 (с "авто"):
- полировочная паста для авто (590) ★ победитель
- полировочная паста для автомобиля (170)
- полировочная паста для машины (10)

ГРУППА 3 (с "кузов"):
- паста для полировки кузова (40) ★ победитель
- паста для полировки кузова авто (20)
- паста для полировки кузова автомобиля (20)
- полировочная паста для кузова (20)
- полировочная паста для кузова авто (20)
```

### Шаг 2: Выбор победителей
- Max volume в группе
- Если volume равен → короче
- Если длина равна → с "авто" (не "автомобиля")

### Шаг 3: Решение о мерже групп
```
ГРУППА 1 vs ГРУППА 2:
- "полировочная паста" (1600) — общий запрос
- "полировочная паста для авто" (590) — уточнённый
→ НЕ мержить! Разный интент (общий vs авто)

ГРУППА 1 vs ГРУППА 3:
- "полировочная паста" (1600) — продукт
- "паста для полировки кузова" (40) — применение
→ НЕ мержить! Разный интент
```

### Шаг 4: Финальный JSON
```json
{
  "primary": [
    {"keyword": "полировочная паста", "volume": 1600}
  ],
  "secondary": [
    {"keyword": "полировочная паста для авто", "volume": 590},
    {"keyword": "паста для полировки кузова", "volume": 40},
    {"keyword": "полировочная паста от царапин", "volume": 260}
  ],
  "supporting": [
    {"keyword": "паста для полировки авто машинкой", "volume": 10}
  ],
  "commercial": [
    {"keyword": "купить полировочную пасту", "volume": 140}
  ]
}
```

---

## Пример: polirovalnye-pasty

### ДО (33 ключа, много дублей)
```
primary: 4     (3 синонима одного ключа)
secondary: 5   (дубли авто/автомобиля)
supporting: 15 (много вариаций одного смысла)
commercial: 9  (дубли купить+авто/автомобиля)
```

### ПОСЛЕ (без дублей)
```
primary:    полировочная паста
secondary:  для авто, для кузова, от царапин
supporting: машинкой, набор паст
commercial: купить полировочную пасту
```

### Что удалено (примеры)
| Удалён | Причина | Победитель |
|--------|---------|------------|
| полировальная паста (20) | орфо-вариант | полировочная паста (1600) |
| паста для полировки (320) | синоним | полировочная паста (1600) |
| полировочная паста для автомобиля (170) | авто > автомобиля | для авто (590) |
| паста для полировки кузова авто (20) | длиннее | для кузова (40) |

---

## Логирование

После очистки добавить в `clustering_notes`:

```json
"clustering_notes": {
  "cleaned_at": "2025-01-01",
  "merged": [
    "полировальная/полировочная → полировочная",
    "авто/автомобиля/машины → авто",
    "кузова авто/автомобиля → кузова"
  ]
}
```

---

## Чеклист валидации

- [ ] Нет дублей авто/автомобиль/машина
- [ ] Нет дублей с разным порядком слов
- [ ] Нет орфо-вариантов (полировочная/полировальная)
- [ ] Все оставшиеся ключи — уникальны по смыслу
- [ ] commercial только для meta (use_in: "meta_only")
- [ ] clustering_notes обновлён

---

## LSI-словарь (удалённые = ресурс для текста!)

Удалённые синонимы использовать в тексте для естественности:
- "автомобиль", "машина" — вместо повторов "авто"
- "полировальная" — вместо повторов "полировочная"
- "кузова автомобиля" — для разнообразия

**Правило:** JSON чистим жёстко, текст пишем естественно.

---

## Категории для очистки (66)

### Автохимия — Мойка
- [ ] aktivnaya-pena
- [ ] avtoshampuni
- [ ] dlya-ruchnoy-moyki
- [ ] kislotnyy-shampun
- [ ] s-voskom

### Автохимия — Кузов
- [ ] antibitum
- [ ] antimoshka
- [ ] glina-i-avtoskraby
- [ ] obezzhirivateli
- [ ] ochistiteli-kuzova
- [ ] pyatnovyvoditeli

### Автохимия — Диски и шины
- [ ] cherniteli-shin
- [ ] ochistiteli-diskov
- [ ] ochistiteli-shin
- [ ] sredstva-dlya-diskov-i-shin
- [ ] zashchitnoe-pokrytie-dlya-koles

### Автохимия — Стёкла
- [ ] antidozhd
- [ ] ochistiteli-stekol
- [ ] omyvatel
- [ ] polirol-dlya-stekla
- [ ] sredstva-dlya-stekol

### Автохимия — Интерьер
- [ ] dlya-khimchistki-salona
- [ ] neytralizatory-zapakha
- [ ] poliroli-dlya-plastika
- [ ] ukhod-za-interyerom

### Автохимия — Кожа
- [ ] chistka-kozhi
- [ ] sredstva-dlya-kozhi
- [ ] ukhod-za-kozhey

### Автохимия — Двигатель и пластик
- [ ] ochistiteli-dvigatelya
- [ ] dlya-vneshnego-plastika

### Защитные покрытия
- [ ] keramika-i-zhidkoe-steklo
- [ ] kvik-deteylery
- [ ] silanty
- [ ] tverdyy-vosk
- [ ] voski
- [ ] zashchitnye-pokrytiya
- [ ] zhidkiy-vosk

### Полировка
- [ ] mekhovye
- [ ] polirovalnye-krugi
- [ ] polirovalnye-mashinki
- [ ] polirovalnye-pasty
- [ ] polirovka
- [ ] porolonovye
- [ ] akkumulyatornye-mashinki

### Аксессуары
- [ ] aksessuary
- [ ] aksessuary-dlya-naneseniya
- [ ] gubki-i-varezhki
- [ ] malyarnyy-skotch
- [ ] mikrofibra-dlya-polirovki
- [ ] mikrofibra-dlya-stekol
- [ ] mikrofibra-i-tryapki
- [ ] raspyliteli-i-penniki
- [ ] shchetki-i-kisti
- [ ] vedra-i-emkosti

### Оборудование
- [ ] apparaty-tornador
- [ ] oborudovanie

### Наборы
- [ ] nabory
- [ ] nabory-dlya-deteylinga
- [ ] nabory-dlya-khimchistki
- [ ] nabory-dlya-kozhi
- [ ] nabory-dlya-moyki
- [ ] nabory-dlya-polirovki
- [ ] podarochnye-nabory

### Служебные (низкий приоритет)
- [ ] glavnaya
- [ ] moyka-i-eksteryer
- [ ] opt
