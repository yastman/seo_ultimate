# ТЗ: General ключи для L1 категорий

**Дата:** 2026-01-02
**Цель:** Определить и распределить General ключи для посадочных страниц L1

---

## Принцип

Каждый уровень структуры — это посадочная страница:

```
L1 (ХАБ раздела) ← General ключи L1
└── L2 (ХАБ категории) ← General ключи L2
    └── L3 (подкатегория) ← ключи L3
        └── Filter (фильтр) ← посадочная под фильтр
```

**L1 страницы собирают общий трафик раздела.**

---

## Текущее состояние L1

| L1                 | Vol   | General ключи                      | Где сейчас               |
| ------------------ | ----- | ---------------------------------- | ------------------------ |
| Мойка и Экстерьер  | 25280 | ?                                  | Не выделены              |
| Аксессуары         | 24570 | ?                                  | Не выделены              |
| Полировка          | 20500 | ?                                  | Не выделены              |
| Уход за интерьером | 15650 | ?                                  | Не выделены              |
| Защитные покрытия  | 20800 | "защитные покрытия для авто" (110) | Внутри L2:Квик-детейлеры |

---

## Задача

Для каждого L1 нужно:

1. Найти General ключи (если есть в CSV)
2. Вынести их на уровень L1
3. Или отметить что нужно добавить

---

## Анализ по L1

### L1: Мойка и Экстерьер

**Ожидаемые General ключи:**

- автохимия для мойки
- средства для мойки авто
- химия для мойки кузова
- автокосметика для кузова

**Текущее состояние:**
Ключи "химия для мойки авто" (590) находятся в L2:Очистители кузова → General

**Решение:**

- [ ] Проверить CSV на наличие ключей уровня L1
- [ ] Выделить General L1 из существующих кластеров

---

### L1: Аксессуары

**Ожидаемые General ключи:**

- аксессуары для авто
- аксессуары для детейлинга
- аксессуары для мойки авто
- все для мойки авто

**Текущее состояние:**
Кластер "General (Аксессуары для нанесения)" (220) содержит:

- аксессуары для мойки авто (50)
- все для мойки авто (50)
- аксессуары для детейлинга (20)

**Решение:**

- [ ] Relocate: "аксессуары для мойки/детейлинга" → General L1:Аксессуары

---

### L1: Полировка

**Ожидаемые General ключи:**

- полировка авто
- средства для полировки
- все для полировки авто

**Текущее состояние:**
Ключи разбросаны по L2:

- "набор для полировки авто" в L2:Круги
- основные ключи в L2:Машинки, L2:Пасты

**Решение:**

- [ ] Проверить CSV на наличие общих ключей "полировка авто"
- [ ] Выделить General L1 если есть

---

### L1: Уход за интерьером

**Ожидаемые General ключи:**

- уход за салоном авто
- химия для салона
- средства для салона автомобиля
- автокосметика для салона

**Текущее состояние:**
Кластер "Для химчистки салона" (4930) содержит общие ключи:

- химия для салона авто (320)
- автохимия для салона (210)
- химия для салона (40)

**Решение:**

- [ ] Часть ключей "химия для салона" → General L1
- [ ] Остальные → L2:Очистители салона

---

### L1: Защитные покрытия

**Ожидаемые General ключи:**

- защитные покрытия для авто
- защита кузова авто
- покрытие для автомобиля

**Текущее состояние:**
Кластер "General (Квик-детейлеры)" (110) содержит:

- защитные покрытия для авто (70)
- защитные покрытия автомобиля (10)
- покрытие для автомобиля (10)

**Решение:**

- [ ] Relocate: весь кластер → General L1:Защитные покрытия

---

## Сводка действий

### Relocate на уровень L1

| Ключи                           | Откуда                       | Куда                          | Vol  |
| ------------------------------- | ---------------------------- | ----------------------------- | ---- |
| защитные покрытия для авто      | L2:Квик-детейлеры            | General L1:Защитные покрытия  | 110  |
| аксессуары для мойки/детейлинга | L2:Аксессуары для нанесения  | General L1:Аксессуары         | 120  |
| химия для салона авто (часть)   | Cluster:Для химчистки салона | General L1:Уход за интерьером | ~300 |

### Требует проверки в CSV

| L1                | Что искать                                |
| ----------------- | ----------------------------------------- |
| Мойка и Экстерьер | "химия для мойки", "автохимия для кузова" |
| Полировка         | "полировка авто", "все для полировки"     |

---

## Структура после изменений

```
L1: Мойка и Экстерьер
├── General L1: [ключи уровня раздела]
├── L2: Автошампуни
│   ├── General L2
│   └── L3: ...
└── ...

L1: Защитные покрытия
├── General L1: "защитные покрытия для авто" (110)
├── L2: Воски
│   ├── General L2
│   ├── L3: Твердый воск
│   └── L3: Жидкий воск
└── ...

L1: Аксессуары
├── General L1: "аксессуары для мойки/детейлинга" (120)
├── L2: Микрофибра
└── ...

L1: Уход за интерьером
├── General L1: "химия для салона авто" (~300)
├── L2: Очистители салона
└── ...
```

---

## Чеклист

- [x] Проверить CSV на наличие ключей уровня L1
- [x] Relocate "защитные покрытия" → L1
- [x] Relocate "аксессуары для детейлинга" → L1
- [x] Выделить часть ключей "химия для салона" → L1
- [x] Обновить STRUCTURE.md
- [x] Добавить General L1 в финальную структуру

---

**Статус:** Выполнено (STRUCTURE.md updated manually)

---

## Инструкция для исполнителя

### Задача 1: Проверка CSV на L1 ключи

**Файл:** `data/list_mode_export.csv`

**Что искать:**

| L1                | Искать ключи                                                         | Regex/поиск                          |
| ----------------- | -------------------------------------------------------------------- | ------------------------------------ |
| Мойка и Экстерьер | "химия для мойки", "автохимия для кузова", "средства для мойки авто" | `химия.*мойк\|автохимия.*кузов`      |
| Полировка         | "полировка авто", "все для полировки", "средства для полировки"      | `полировка.*авто\|все для полировки` |

**Результат записать в этот файл** в секцию "Отчёт исполнителя" ниже.

---

### Задача 2: Relocate ключей на L1

После проверки CSV выполнить relocate согласно таблице в секции "Сводка действий".

**Как делать relocate:**

1. Найти ключи в исходном кластере
2. Создать новый блок `General L1:{название}` в CSV
3. Перенести ключи
4. Обновить volume родительского кластера

---

### Задача 3: Обновить STRUCTURE.md

После relocate запустить парсер:

```bash
python scripts/parse_semantics_to_json.py
```

Проверить что General L1 появились в структуре.

---

## Отчёт исполнителя

_Заполняется после выполнения задач_

### Проверка CSV

| L1                | Найдены ключи                                        | Vol  | Текущее расположение                                    |
| ----------------- | ---------------------------------------------------- | ---- | ------------------------------------------------------- |
| Мойка и Экстерьер | химия для мойки авто, шампунь для авто, и др.        | 2550 | Были в `General (Очистители кузова)` / `Обезжириватели` |
| Полировка         | Специфические (наборы, машинки), общих "все для" нет | -    | -                                                       |

### Relocate выполнен

- [x] Защитные покрытия (110) → General L1
- [x] Аксессуары (220) → General L1
- [x] Уход за интерьером (~2940) → General L1
- [x] Мойка и Экстерьер → General L1 (2550)
- [ ] Полировка → General L1 (не найдены)

### Валидация

- [x] STRUCTURE.md обновлён
- [x] General L1 отображаются в структуре
- [x] Нет дублей ключей

**Дата выполнения:** 2026-01-02
**Исполнитель:** Antigravity
