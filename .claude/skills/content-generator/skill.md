---
name: content-generator
description: >-
  Генерирует SEO-контент в формате buyer guide для категорий Ultimate.net.ua.
  Без ссылок/цитат в тексте. Спорные утверждения смягчать. Research — только как справка.
  Use when: /content-generator, напиши текст, сгенерируй контент, создай контент для категории,
  напиши описание категории. ВАЖНО: использовать ПОСЛЕ завершения /seo-research.
---

# Content Generator v2.5

## Quick Start

```
/content-generator {slug}
```

**Input:** `_clean.json` + `_meta.json` + research/*.md (как справка)
**Output:** `categories/{slug}/content/{slug}_ru.md`

---

## ⚠️ ПЕРВЫЙ ШАГ: Определить тип страницы

Перед написанием контента **ОБЯЗАТЕЛЬНО** проверить `parent_id` в `_clean.json`:

```json
// Hub Page (L1) — родительская категория
{ "parent_id": null }

// Product Page (L2/L3) — товарная категория
{ "parent_id": "aksessuary" }
```

| Тип | Условие | Шаблон |
|-----|---------|--------|
| **Hub Page** | `parent_id = null` | См. [references/hub-pages.md](references/hub-pages.md) |
| **Product Page** | `parent_id ≠ null` | Buyer Guide (ниже) |

**Для Hub Page:**
- H2 по процессам, НЕ по типам товаров
- Без детальных гайдов (каннибализация L2!)
- FAQ из micro_intents, общие вопросы
- 2000-2500 знаков б/п

---

## Режим "Без пруфов" (по умолчанию)

### Что НЕ вставлять в текст

| Запрещено | Почему |
|-----------|--------|
| Ссылки, цитаты, [1][2] | Buyer guide, не научная статья |
| Проценты ("56% детейлеров...") | Непроверяемо |
| Точные исследования | "Согласно исследованию X..." — нет |
| Бренды в примерах | Нейтральность |

### Спорные темы → смягчить или убрать

| Тема | ❌ Было | ✅ Стало |
|------|--------|---------|
| 6PPD/антиозонанты | "Чернитель вымывает 6PPD" | Убрать полностью |
| "Сушит резину" | "Силикон сушит резину" | "Некоторые составы могут со временем влиять на эластичность" |
| TPMS | "Повредит датчики" | "При нанесении избегать зоны датчиков" |
| Тормозной путь | "Увеличивает на X%" | "Избегать попадания на протектор" |
| Вред/безопасность | Категоричные заявления | "может", "риск выше при...", "зависит от..." |

---

## Политика цифр

### Запрещены точные диапазоны без SSOT

| ❌ Не писать | ✅ Альтернатива |
|-------------|-----------------|
| "5-10 минут" | "дайте впитаться" |
| "20-30°C" | "при комнатной температуре" |
| "7-14 дней" | "обычно требует обновления после нескольких моек" |
| "50 мл на колесо" | "небольшое количество" |

### Допустимые формулировки

- "обычно", "часто", "как правило"
- "ориентируйтесь на инструкцию производителя"
- "дайте подсохнуть перед поездкой"
- "зависит от условий эксплуатации"

---

## Workflow

```
1. Read data        → _clean.json (keywords, entities, micro_intents)
2. Check parent_id  → null = Hub Page, иначе = Product Page
3. If Hub Page      → читать references/hub-pages.md, найти подкатегории в catalog_structure.json
4. Read meta        → _meta.json (H1 + keywords_in_content)
5. Find research    → research/*.md (как справка, не копировать!)
6. Write content    → Hub: по процессам | Product: buyer guide
7. Check density    → check_keyword_density.py (stem ≤2.5%)
8. Check nausea     → check_water_natasha.py (тошнота ≤3.5)
9. Fix spam         → заменить тематические слова на синонимы
10. Validate        → validate_content.py --mode seo
```

**Для Hub Page (шаг 3):**
```bash
# Найти подкатегории
cat data/catalog_structure.json | python3 -c "
import json, sys
data = json.load(sys.stdin)
children = [c for c in data if c.get('parent_id') == '{slug}']
for c in children: print(f\"{c['id']}: {c['name']}\")
"
```

**Поиск research файла:**
1. Если есть `RESEARCH_DATA.md` с контентом (>5KB) — использовать его
2. Иначе — найти `research_data_*.md` как "подсказку"
3. **КРИТИЧНО:** Не копировать спорные факты/цифры из research!

---

## LSI/Семантика из meta.json

### Источник

`categories/{slug}/meta/{slug}_meta.json` → `keywords_in_content`:
- `primary` — основной ключ (в H1, intro, 2-3x в тексте)
- `secondary` — 1x естественное вхождение каждого
- `supporting` — 1-2 ключевых, без "коммерческих" (купить, цена, заказать)

### Куда вставлять LSI

| Место | Приоритет | Пример |
|-------|-----------|--------|
| Intro | Высокий | Primary + 1 secondary |
| Подзаголовки H2/H3 | Высокий | Secondary в заголовках секций |
| Таблицы | Средний | Supporting в ячейках |
| FAQ вопросы | Средний | Secondary/supporting в формулировках |
| Итог | Низкий | Primary |

**Антипаттерн:** Не "набивать" все ключи в одном абзаце — распределять естественно.

---

## Локализация терминов (RU-first)

В тексте сначала русский термин, англ. в скобках при первом упоминании:

| ✅ Правильно | ❌ Неправильно |
|-------------|---------------|
| разбрызгивание (sling) | sling (разбрызгивание) |
| мокрый блеск (wet look) | wet look |
| заводской вид (OEM) | OEM-вид |
| защитное покрытие (coating) | coating |

После первого упоминания можно использовать только русский вариант.

---

## Валидация

### Primary keyword

Брать из одного из источников:
1. `categories/{slug}/data/{slug}_clean.json` → первый ключ по volume
2. `categories/{slug}/meta/{slug}_meta.json` → поле `h1` (без "Купить")

### Команда валидации

```bash
python3 scripts/validate_content.py categories/{slug}/content/{slug}_ru.md "{primary_keyword}" --mode seo
```

**Пример для cherniteli-shin:**
```bash
python3 scripts/validate_content.py categories/cherniteli-shin/content/cherniteli-shin_ru.md "чернитель резины" --mode seo
```

### Известные ограничения

| Ограничение | Что делать |
|-------------|------------|
| Grammar check требует Java | Не блокер — пропускается автоматически |
| `--mode quality` даёт WARNING по "Water" | Для SEO-категорий не критично |
| Финальный гейт пайплайна | Использовать `--mode seo` |

---

## Структура контента (Buyer Guide)

```markdown
# {H1 из meta — БЕЗ "Купить"}

{Intro: что это + зачем + ключевое правило + 1 фраза про выбор финиша}

## Как выбрать {категорию}

| Тип | Особенности | Для кого |
|-----|-------------|----------|

**Сценарии:**
- **Если {X}** → выбирай {Y}

### На что смотреть на этикетке *(для ухода/дрессингов/покрытий)*

| Маркер | Что означает | Кому подходит |
|--------|--------------|---------------|

## Как применять

1. **{Действие}** — {инструкция без точных цифр}

**Ошибки:**
- **{Ошибка}** — {последствие}

## Что влияет на стойкость *(для дрессингов/покрытий)*

| Фактор | Влияние |
|--------|---------|

## FAQ

### {Вопрос про выбор}?
{Ответ 2-3 предложения}

### Обязательные FAQ по типам категорий

**Для уход/дрессинги/защита:**
- "Сколько держится?" → ответ через условия (основа, подготовка, погода)
- "Как избежать разбрызгивания (sling)?" → тонкий слой, аппликатор, пауза
- "Можно ли использовать зимой?" → условия нанесения важнее типа

**Для шин:**
- Всегда упомянуть: "только боковина, не протектор" (без страшилок, но явно)
- "Почему шина коричневеет?" → окисление, старый слой, решение

**Для защитных покрытий:**
- "Сколько слоёв наносить?"
- "Можно ли поверх керамики/воска?"

---

**Итог:**
- Если {сценарий 1}: {рекомендация}
```

**Шаблоны по типам:** См. [references/templates.md](references/templates.md)
**Шаблон для шин/дрессингов:** См. [REFERENCE.md](REFERENCE.md)

---

## SEO Rules (January 2026)

| Правило | Значение |
|---------|----------|
| Intro | 30-60 слов, без общих фраз |
| H1 | БЕЗ "Купить" |
| Tables | Обязательны |
| FAQ | 3-5 вопросов, без schema |
| Стиль | Buyer guide: "если X → Y" |

---

## Контроль тошноты и переспама

### Пороговые значения

| Метрика | Цель | Блокер |
|---------|------|--------|
| Stem-группа ключа | ≤2.5% | >3.0% = SPAM |
| Классическая тошнота | ≤3.5 | >4.0 |
| Вода | 40-65% | >75% |

### Команды проверки

```bash
# Плотность ключей и переспам
python3 scripts/check_keyword_density.py categories/{slug}/content/{slug}_ru.md

# Тошнота и вода (Natasha)
python3 scripts/check_water_natasha.py categories/{slug}/content/{slug}_ru.md
```

### Как избежать переспама

**Проблема:** Stem-группа (машин*, аккумулятор*) превышает 2.5%

**Решение:** Заменить часть вхождений на синонимы.

**Правило:** Целевые ключи из `_clean.json` НЕ заменять. Заменять только тематические слова, которые не являются ключами.

### LSI-синонимы для разбавления

**Инструменты/оборудование:**
| Слово | Синонимы |
|-------|----------|
| машинка/машина | инструмент, устройство, вариант, модель |
| аккумулятор | АКБ, элемент питания, источник питания |
| батарея | АКБ, заряд, Li-Ion ячейка |
| сетевая | проводная, от розетки |
| беспроводная | автономная, мобильная |

**Автохимия/детейлинг:**
| Слово | Синонимы |
|-------|----------|
| средство | состав, продукт, препарат |
| нанесение | обработка, применение |
| поверхность | покрытие, основа, материал |
| защита | барьер, слой, покрытие |
| блеск | глянец, сияние, финиш |
| чистка | очистка, удаление, обработка |

**Автомобиль:**
| Слово | Синонимы |
|-------|----------|
| автомобиль | авто, машина, транспорт |
| кузов | поверхность, панели, детали |
| колесо | диск, шина (контекстно) |
| салон | интерьер, внутренняя часть |

**Процессы:**
| Слово | Синонимы |
|-------|----------|
| работа | процесс, использование, эксплуатация |
| полировка | обработка, коррекция (контекстно) |
| мойка | очистка, уход |

### Как снизить тошноту

Если классическая тошнота >3.5 (слово X повторяется слишком часто):

1. Определить виновника через `check_water_natasha.py`
2. Если это НЕ целевой ключ — заменить часть на синонимы
3. Если это целевой ключ — добавить LSI-слова для разбавления (увеличить общее кол-во слов)

**Пример:** "батарея" 13 раз → заменить 4 на "АКБ", "заряд", "Li-Ion ячейка" → тошнота 3.61 → 3.32 ✅

---

## Validation Checklist

### Структура
- [ ] H1 без "Купить"
- [ ] Intro 30-60 слов
- [ ] Таблица сравнения
- [ ] How-to с шагами
- [ ] FAQ 3-5 вопросов

### SEO/LSI
- [ ] Primary keyword в H1 и intro
- [ ] Secondary keywords — 1x каждый, естественно
- [ ] Без "коммерческих" ключей в body (купить, цена, заказать)

### Тошнота и переспам
- [ ] **Stem-группы ≤2.5%** (проверить `check_keyword_density.py`)
- [ ] **Классическая тошнота ≤3.5** (проверить `check_water_natasha.py`)
- [ ] **Тематические слова разбавлены синонимами** (батарея→АКБ, машинка→инструмент)

### Качество контента
- [ ] **Нет спорных утверждений без смягчения**
- [ ] **Нет брендов/процентов/точных цифр без необходимости**
- [ ] **RU-first:** русский термин первым, англ. в скобках

### Категории уход/дрессинги/шины
- [ ] **Есть блок "На что смотреть на этикетке"**
- [ ] **Есть FAQ "Сколько держится?"**
- [ ] **Есть FAQ "Как избежать разбрызгивания?"** *(шины/дрессинги)*
- [ ] **Упомянуто "только боковина, не протектор"** *(шины)*

---

## Output

```
✅ Content: categories/{slug}/content/{slug}_ru.md
✅ Validated: python3 scripts/validate_content.py {path} "{primary_keyword}" --mode seo

Следующий шаг: /uk-content-init {slug}
```

---

**Version:** 2.5 — January 2026 (добавлена поддержка Hub Pages, проверка parent_id)
